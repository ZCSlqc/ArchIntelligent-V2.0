# 筑园商务咨询平台

## 项目概述

本项目旨在为筑园平台开发一个商务咨询助手，面向有设计咨询需求的客户并提供引导服务。该助手将提供平台的基本介绍与使用指引，并协助用户查找和匹配合适的设计师资源。核心功能之一是构建基于检索增强生成（RAG）技术的建筑规范智能咨询系统：该系统能够解析和索引PDF文档以构建知识库，并通过Web界面允许用户查询文档内容；用户将获得由大语言模型（LLM）生成的智能回复，并附带原文引用出处。此外，助手支持用户上传意向图片，通过分析图片理解客户需求，进而对接相应的设计师资源。最终，助手将生成所需的合同文档，为客户提供一站式解决方案。

## 核心功能需求

1. **基本问询**：

   - 提供筑园平台相关介绍
   - 引导用户开始使用平台服务
   - 为用户提供匹配设计师

2. **文档处理**：

   - 读取指定目录中的所有 PDF 文件
   - 提取文本内容并进行分块处理
   - 生成文本嵌入向量并存储

3. **知识库构建**：

   - 使用 PGVector 作为向量数据库
   - 建立高效的检索索引
   - 保存文档元数据（如文件名、页码等）

4. **用户查询界面**：

   - 提供简洁的 Web 前端界面，采用聊天形式
   - 接收用户自然语言问题，也可以接收图像
   - 展示 LLM 回答及相关原文引用

5. **回答生成**：
   - 基于用户查询检索相关文档片段
   - 使用 LLM 生成连贯、准确的回答
   - 在回答中引用原始文档来源（文件名及相关段落）

6. **图像理解**：
   - 基于miniCPM大语言模块读取图片
   - 使用 LLM 生成连贯、准确的回答
   - 在后台形成设计师意向参考的关键词

## 技术栈

1. **后端**：

   - Python 3.10+
   - Flask：Web 服务与接口开发
   - LlamaIndex：文档处理、索引构建和查询处理
   - PostgreSQL + PGVector：向量存储和相似度搜索
   - Python-dotenv：环境变量管理（LLM API 密钥等）

2. **前端**：

   - HTML：构建简洁的 Web 用户界面

3. **LLM 集成**：

   - 通过.env 文件配置的 API 密钥和 BaseURL 连接外部 LLM 服务

4. **文档处理**：

   - PyPDF2/PDFMiner：PDF 文本提取
   - LlamaIndex 文档加载器和处理器
   - 支持混合检索(BM25 及稠密向量检索)及重排序

5. **部署**
   - 支持本地运行
   - 支持 docker 部署

## 实现思路

我们将创建一个极简但功能完整的 咨询助手 应用，包含以下核心组件：

1. 文档加载器：读取 PDF 文件并提取文本
2. 文本处理器：将文档分割成适当大小的块
3. 向量数据库连接器：使用 PGVector 存储嵌入
4. 检索引擎：基于用户查询找到相关文档片段
5. LLM 集成：生成回答并引用来源
6. 图像理解：生成上传图像描述
7. 排序推荐：根据历史信息总结，筛选适合推荐人选
8. Web 界面：基于 Flask 提供用户交互功能

